<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- member 테이블 관련 SQL 구문만 처리한다. 

	1. DTD가져오기 [#2번]
	https://mybatis.org/mybatis-3/ko/getting-started.html
	매핑된 SQL 구문 살펴보기
-->

<!-- namespace : 외부에서 해당 파일을 구분할 수 있도록 하는 값 -->
<mapper namespace="com.company.mapper.MemberMapper">

	<!-- 				< 회원 관련 Mapper > 						-->

	<!-- 회원가입  -->	
	<insert id="signUp">
	<![CDATA[
	INSERT INTO member(name, email, pwd)
	VALUES (#{name}, #{email}, #{pwd})
	]]>
	</insert>
	<!-- 회원가입  -->	

	<!-- ID에 맞는 회원 정보 가져오기 -->
	<select id="getMem" resultType="com.company.domain.MemberVO">
	<![CDATA[
	SELECT name
	FROM member
	WHERE email = #{email}
	]]>
	</select>
	<!-- ID에 맞는 회원 정보 가져오기 -->


	<!-- 로그인 -->
	<select id="signIn" resultType="com.company.domain.MemberVO">
	<![CDATA[
	SELECT email, pwd 
	FROM member
	WHERE email = #{email}
	AND pwd = #{pwd}
	]]>
	</select>
	<!-- 로그인 -->


	<!-- 회원 정보 수정 -->
	<update id="modify">
	<![CDATA[
	UPDATE member
	SET pwd = #{pwd}, rev_date = now()
	WHERE email = #{email}
	]]>
	</update>
	<!-- 회원 정보 수정 -->


	<!-- 회원탈퇴 -->
	<delete id="dropOut">
	DELETE FROM member
	WHERE email = #{email}
	AND pwd = #{pwd}
	</delete>
	<!-- 회원탈퇴 -->


	<!-- 멤버십 정보 조회 -->
	<select id="getMembership" resultType="com.company.domain.MemberVO">
	<![CDATA[ 
	SELECT membership_type, membership_reg_date, membership_end_date, membership_pay
	FROM member
	WHERE email = #{email}
	]]>
	</select>
	<!-- 멤버십 정보 조회 -->
	
	
	<!-- [관리자] 회원 정보 전체 조회 -->
	<select id="getMembers" resultType="com.company.domain.MemberVO">
	SELECT idx, email, reg_date, membership_type, membership_reg_date, membership_end_date
	FROM member
	</select>
	<!-- [관리자] 회원 정보 전체 조회 -->
	

</mapper>